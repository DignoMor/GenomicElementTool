---
title: filter_motif_score Subcommand
description: Filter genomic regions based on motif search scores
---

# filter_motif_score Subcommand

The `filter_motif_score` subcommand allows you to filter genomic regions from a BED file based on the scores generated by the `motif_search` subcommand. It produces a new BED file containing only the regions that pass the score threshold at a specific position (base).

## Usage

```bash
GenomicElementTool.py filter_motif_score [OPTIONS]
```

## Required Arguments

- `--region_file_path` (str)
  - Path to the original region file (BED format) used for motif searching
  - Required: Yes

- `--region_file_type` (str)
  - Type of the region file
  - Required: Yes
  - Valid types: `bed3`, `bed6`, `bed6gene`, `bedTRE`, etc.

- `--motif_search_npy` (str)
  - Path to the NumPy file (.npy) containing motif search scores (generated by `motif_search`)
  - Required: Yes

- `--output_header` (str)
  - Header prefix for output files
  - Required: Yes
  - Output files will be `<output_header>.bed` and `<output_header>.motif.npy`

- `--filter_base` (int)
  - The index of the base within each region to use for filtering. 
  - For example, if your regions are centered on a feature, index `L/2` might be the center.

## Optional Arguments

- `--min_score` (float)
  - Minimum motif score required to keep a region
  - Default: `-inf`

- `--max_score` (float)
  - Maximum motif score allowed to keep a region
  - Default: `inf`

## Output

The program generates two files:

1. **BED file**: `<output_header>.bed`
   - Contains the genomic regions that passed the filter.
   - Maintains the same format as the input region file.

2. **NumPy array file**: `<output_header>.motif.npy`
   - Contains the motif scores for the filtered regions.
   - This allows for further downstream analysis or cascading filters.

## How It Works

1. **Load Genomic Elements**: Reads the regions from the input BED file.
2. **Load Motif Scores**: Loads the scores from the specified `.npy` file and associates them with the regions.
3. **Apply Filter**: For each region, it checks if the score at the specified `filter_base` is within the range `(min_score, max_score)`.
4. **Save Results**: Writes the passing regions to a new BED file and their corresponding scores to a new NumPy file.

## Examples

### Filter regions with high motif score at the center

Suppose your regions are 200bp long, and you want to keep regions where the motif score at the center (index 100) is greater than 5.0.

```bash
GenomicElementTool.py filter_motif_score \
    --region_file_path input_regions.bed6 \
    --region_file_type bed6 \
    --motif_search_npy motif_search.Motif1.npy \
    --filter_base 100 \
    --min_score 5.0 \
    --output_header filtered_regions
```

This will create:
- `filtered_regions.bed`
- `filtered_regions.motif.npy`

## Dependencies

- numpy
- RGTools.GenomicElements

